# AWS ハンズオンの進め方

2019/11/28 C-CAT 岡田

ハンズオンのドキュメントを開きます。  
今回のハンズオンはこの WEB ドキュメントに沿って進めます。

ハンズオン限定短縮URL
http://urx.space/23Gv

正式URL
https://ncc-ccat-gap.github.io/ncc-ccat-gap-pages/cellranger/html/index.html

--------------------------------------------------------------

## AWS Cloud9 でハンズオン環境を作成します。

ドキュメント左のメニューで「5. AWS Cloud9 の使用方法」をクリックしてください。

以下を順番に行います。  

 - 5.1. AWS コンソールにログイン
    * https://genomon-devel.signin.aws.amazon.com/console を WEB ブラウザで開きます。
    * ユーザ名、パスワードは配布したドキュメントのものを使用してください。
    * アカウントを聞かれた場合は「genomon-devel」を入力してください。

 - 5.2. EC2 インスタンスの起動
 - 5.3. ボリュームの追加
 - 5.4. work ディレクトリの準備

--------------------------------------------------------------

## Cell Ranger をインストールします。

ドキュメント左のメニューで「1. Cell Ranger のインストール」をクリックしてください。

以下を順番に行います。  

 - 1.2. Cell Ranger をダウンロード
 - 1.3. リファレンスファイルの準備
 - 1.4. Cell Ranger にパスを通す
 - 1.6. bcl2fastq をインストール

※ 「1.5. インストールの確認」は約10分程度かかりますので、飛ばして問題ありません。

--------------------------------------------------------------

## cellranger mkfastq を実行します。

ドキュメント左のメニューで「2. cellranger mkfastq の実行」をクリックしてください。

以下を順番に行います。  

 - 2.1. コマンドとオプション　←　サンプルのダウンロードのみ行います。まだcellrangerを実行しません。
 - 2.2. csv オプションで実行
 - 2.3. csv サンプルシートを確認
 - 2.4. samplesheet オプションで実行
 - 2.5. Quality Control をつけて実行

--------------------------------------------------------------

## cellranger count を実行します。

ドキュメント左のメニューで「3. cellranger count の実行」をクリックしてください。

以下を行います。  

 - 3.1. 簡単なサンプルで実行

コマンドが成功したら解析結果を見てみましょう。  
以下のコマンドでファイルを移動します。

```
mv /work/tiny-bcl3-count/outs ~/environment/
```

`environment` のファイルは左ファイルツリーからアクセスすることができます。  
「web_summary.html」を右クリックして「Preview」を選択してください。  
画面に表示されます。

<img src="./preview.PNG" />

※ 「3.2. 現実的なデータで実行」は約3時間かかりますので、今回は実行しません。  
ページ一番下に解析結果のリンクを記載していますので、興味のある方は開いてみてください。

--------------------------------------------------------------

以上で終了です。  
作成したインスタンスはこちらで削除しますのでそのままブラウザを閉じてください。  
おつかれさまでした。

