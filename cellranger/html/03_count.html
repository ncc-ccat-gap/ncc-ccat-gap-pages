<html lang="ja">
<head>
  <title></title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <link rel="stylesheet" type="text/css" href="./github-markdown.css"/>
    <link rel="stylesheet" type="text/css" href="./extention.css"/>
<script src="./js/jquery.js"></script>
<script src="./js/toc.js"></script>
</head>
<body>
<div class="toc">
</div>
<div id="contents">

<p>2019.7.31　作成　NCC</p>
<h2>
<a id="user-content-3-cellranger-count-を実行してみる" class="anchor" href="#3-cellranger-count-%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3. cellranger count を実行してみる</h2>
<p>この項では <code>cellranger count</code> を使用して Single-Library Analysis を行います。</p>
<p>公式ドキュメント：<a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/using/count" rel="nofollow">Single-Library Analysis with Cell Ranger</a></p>
<h3>
<a id="user-content-3-1-サンプルを使用して実行する" class="anchor" href="#3-1-%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3-1. サンプルを使用して実行する</h3>
<p>順番に実行していれば 2-5 までの結果がありますので、それを使用して <code>cellranger count</code> コマンドを実行します。</p>
<div class="highlight highlight-source-shell"><pre><span class="pl-c1">cd</span> /work
cellranger count --id=tiny-bcl3-count \
--transcriptome=./refdata-cellranger-GRCh38-and-mm10-3.1.0 \
--fastqs=./tiny-bcl3/outs/fastq_path \
--expect-cells=1000</pre></div>
<p>--fastqs オプションに前回の出力結果のうち、fastq_path ディレクトリを渡します。<br>
--transcriptome オプションには 1-3 でダウンロードしたリファレンスファイルのディレクトリを指定します。<br>
--except-cells は期待されるセル数ですが、ここでは公式ドキュメントのとおり、1000とします。（デフォルトは3000です）</p>
<p>その他オプションは公式ドキュメントを参照してください。
<a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/using/count#args" rel="nofollow">Command Line Argument</a></p>
<h3>
<a id="user-content-3-2-現実的なデータで実行する" class="anchor" href="#3-2-%E7%8F%BE%E5%AE%9F%E7%9A%84%E3%81%AA%E3%83%87%E3%83%BC%E3%82%BF%E3%81%A7%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3-2. 現実的なデータで実行する</h3>
<p>10xgenomics は Single Cell Gene Expression Datasets を用意していますので、ダウンロードして試してみます。</p>
<p><a href="https://support.10xgenomics.com/single-cell-gene-expression/datasets" rel="nofollow">https://support.10xgenomics.com/single-cell-gene-expression/datasets</a></p>
<p>上記のうち、「1k PBMCs from a Healthy Donor (v3 chemistry)」をダウンロードします。</p>
<div class="highlight highlight-source-shell"><pre>wget http://cf.10xgenomics.com/samples/cell-exp/3.0.0/pbmc_1k_v3/pbmc_1k_v3_fastqs.tar
tar xvf pbmc_1k_v3_fastqs.tar</pre></div>
<p>cellranger cout を実行します。<br>
--fastqs にダウンロードしたサンプルの fastq ディレクトリを指定します。<br>
--except-cells にはサンプルのページに <code>run with --expect-cells=1000</code> と記載がありますので、1000 を指定します。</p>
<div class="highlight highlight-source-shell"><pre>cellranger count --id=pbmc_1k_v3 \
--transcriptome=./refdata-cellranger-GRCh38-and-mm10-3.1.0 \
--fastqs=./pbmc_1k_v3_fastqs/ \
--expect-cells=1000</pre></div>
<p>以下はログの一部です。<br>
"Pipestance completed successfully!" と表示されていれば成功です。<br>
全体のログは <a href="../data/cellranger_count_pbmc_1k_v3.log">ここ</a> にアップロードしています。</p>
<pre><code>$ cellranger count --id=pbmc_1k_v3 \
&gt; --transcriptome=./refdata-cellranger-GRCh38-and-mm10-3.1.0 \
&gt; --fastqs=./pbmc_1k_v3_fastqs/ \
&gt; --expect-cells=1000
(省略)

Outputs:
- Run summary HTML:                         /work/pbmc_1k_v3/outs/web_summary.html
- Run summary CSV:                          /work/pbmc_1k_v3/outs/metrics_summary.csv
- BAM:                                      /work/pbmc_1k_v3/outs/possorted_genome_bam.bam
- BAM index:                                /work/pbmc_1k_v3/outs/possorted_genome_bam.bam.bai
- Filtered feature-barcode matrices MEX:    /work/pbmc_1k_v3/outs/filtered_feature_bc_matrix
- Filtered feature-barcode matrices HDF5:   /work/pbmc_1k_v3/outs/filtered_feature_bc_matrix.h5
- Unfiltered feature-barcode matrices MEX:  /work/pbmc_1k_v3/outs/raw_feature_bc_matrix
- Unfiltered feature-barcode matrices HDF5: /work/pbmc_1k_v3/outs/raw_feature_bc_matrix.h5
- Secondary analysis output CSV:            /work/pbmc_1k_v3/outs/analysis
- Per-molecule read information:            /work/pbmc_1k_v3/outs/molecule_info.h5
- CRISPR-specific analysis:                 null
- Loupe Cell Browser file:                  /work/pbmc_1k_v3/outs/cloupe.cloupe

Waiting 6 seconds for UI to do final refresh.
Pipestance completed successfully!

2019-01-30 09:08:05 Shutting down.
Saving pipestance info to pbmc_1k_v3/pbmc_1k_v3.mri.tgz
</code></pre>
<p>実行ログの最後 "Outputs:" にサマリの出力場所が記載されています。</p>
<pre><code>Run summary HTML:                         /work/pbmc_1k_v3/outs/web_summary.html
</code></pre>
<p><a href="../data/pbmc_1k_v3/outs/web_summary.html">ここ</a> にアップロードしていますので、興味があれば参考に見てください。</p>
<hr>
<p><a href="./99_ui.html">Option. Cell Ranger ユーザインタフェースの利用</a> に進んでください。</p>

</div>

<script>
    $('.toc').toc({
        'container': '#contents',
        'selectors': 'h2, h3',
    });
</script>
</body>
</html>
