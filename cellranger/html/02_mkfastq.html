<html lang="ja">
<head>
  <title></title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <link rel="stylesheet" type="text/css" href="./github-markdown.css"/>
    <link rel="stylesheet" type="text/css" href="./extention.css"/>
</head>
<body>
<p>2019.7.31　作成　NCC</p>
<h2>
<a id="user-content-2-cellranger-mkfastq-を実行してみる" class="anchor" href="#2-cellranger-mkfastq-%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. cellranger mkfastq を実行してみる</h2>
<p>この項では <code>cellranger mkfastq</code> を使用して FASTQ を生成します。</p>
<p>公式ドキュメント：<a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/using/mkfastq" rel="nofollow">Generating FASTQs with cellranger mkfastq</a></p>
<h3>
<a id="user-content-2-1-コマンドとオプション" class="anchor" href="#2-1-%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%81%A8%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2-1. コマンドとオプション</h3>
<p>cellranger mkfastq コマンドの基本形は以下のどちらかです</p>
<h4>
<a id="user-content---csv-オプションを使用する場合-10xgenomics-推奨" class="anchor" href="#--csv-%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88-10xgenomics-%E6%8E%A8%E5%A5%A8" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>--csv オプションを使用する場合 (10xGenomics 推奨)</h4>
<p><a href="../data/cellranger-tiny-bcl-simple-1.2.0.csv">csv サンプルはこちら</a></p>
<pre><code>cellranger mkfastq --id=tiny-bcl --run=./data/cellranger-tiny-bcl-1.2.0 --csv=./data/cellranger-tiny-bcl-simple-1.2.0.csv
</code></pre>
<h4>
<a id="user-content---samplesheet-オプションを使用する場合" class="anchor" href="#--samplesheet-%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>--samplesheet オプションを使用する場合</h4>
<p>samplesheet とは Illumina Experiment Manager互換のサンプルシートのことであり、ファイルのパスを指定します。</p>
<p><a href="../data/cellranger-tiny-bcl-samplesheet-1.2.0.csv">samplesheet サンプルはこちら</a></p>
<pre><code>cellranger mkfastq --id=tiny-bcl2 --run=./data/cellranger-tiny-bcl-1.2.0 --samplesheet=./data/cellranger-tiny-bcl-samplesheet-1.2.0.csv
</code></pre>
<p>どちらにしても --run オプションは必須であり、 Illumina BCL へのパスを指定します。</p>
<p>--id は出力ディレクトリです。必須ではありませんが明示したほうがよいでしょう。デフォルトは--runオプションで指定されるフローセルの名前です。</p>
<p>また、qcを実行するには --qc オプションも合わせて指定する必要があります。</p>
<p>その他のオプションについては 10xGENOMICS のドキュメント <a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/using/mkfastq#arguments_options" rel="nofollow">Arguments and Options</a> を参照してください。</p>
<p>サンプルが提供されていますので、ダウンロードしておきます。</p>
<div class="highlight highlight-source-shell"><pre><span class="pl-c1">cd</span> /work
mkdir data
<span class="pl-c1">cd</span> data
wget http://cf.10xgenomics.com/supp/cell-exp/cellranger-tiny-bcl-1.2.0.tar.gz
wget http://cf.10xgenomics.com/supp/cell-exp/cellranger-tiny-bcl-simple-1.2.0.csv
wget http://cf.10xgenomics.com/supp/cell-exp/cellranger-tiny-bcl-samplesheet-1.2.0.csv</pre></div>
<p>ダウンロードしたファイルを解答します。</p>
<div class="highlight highlight-source-shell"><pre>tar -xzvf cellranger-tiny-bcl-1.2.0.tar.gz</pre></div>
<p>ここまでの作業により、データは以下のように配置されているはずです。</p>
<div class="highlight highlight-source-shell"><pre>
/work
├── data
│         ├── cellranger-tiny-bcl-1.2.0
│         └── cellranger-tiny-bcl-simple-1.2.0.csv
│         └── cellranger-tiny-bcl-samplesheet-1.2.0.csv
└── refdata-cellranger-GRCh38-and-mm10-3.1.0</pre></div>
<h3>
<a id="user-content-2-2-簡単な-csv-サンプルシートを使用して-mkfastq-を実行する" class="anchor" href="#2-2-%E7%B0%A1%E5%8D%98%E3%81%AA-csv-%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%B7%E3%83%BC%E3%83%88%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6-mkfastq-%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2-2. 簡単な csv サンプルシートを使用して mkfastq を実行する</h3>
<p><code>cellranger mkfastq</code> コマンドを実行します。</p>
<div class="highlight highlight-source-shell"><pre><span class="pl-c1">cd</span> /work
cellranger mkfastq --id=tiny-bcl --run=./data/cellranger-tiny-bcl-1.2.0 --csv=./data/cellranger-tiny-bcl-simple-1.2.0.csv</pre></div>
<p>実行ログは以下のように出力されます。 <code>Pipestance completed successfully!</code> と表示されていれば成功です。</p>
<div class="highlight highlight-source-shell"><pre>$ cellranger mkfastq --id=tiny-bcl --run=./data/cellranger-tiny-bcl-1.2.0 --csv=./data/cellranger-tiny-bcl-simple-1.2.0.csv
(省略)

Outputs:
- Run QC metrics:        null
- FASTQ output folder:   /work/tiny-bcl/outs/fastq_path
- Interop output folder: /work/tiny-bcl/outs/interop_path
- Input samplesheet:     /work/tiny-bcl/outs/input_samplesheet.csv

Waiting 6 seconds <span class="pl-k">for</span> UI to <span class="pl-k">do</span> final refresh.
Pipestance completed successfully<span class="pl-k">!</span>

2019-01-29 09:49:24 Shutting down.
Saving pipestance info to tiny-bcl/tiny-bcl.mri.tgz</pre></div>
<p>全体のログは <a href="../data/cellranger_mkfastq_tiny-bcl.log">ここ</a> です。</p>
<h3>
<a id="user-content-2-3-実行した-csv-サンプルシートを確認する" class="anchor" href="#2-3-%E5%AE%9F%E8%A1%8C%E3%81%97%E3%81%9F-csv-%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%B7%E3%83%BC%E3%83%88%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%99%E3%82%8B" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2-3. 実行した csv サンプルシートを確認する</h3>
<p>サンプルシートを見てみます。
Lane, Sample, Index の構成になっています。</p>
<pre><code>$ cat /work/data/cellranger-tiny-bcl-simple-1.2.0.csv
Lane,Sample,Index
1,test_sample,SI-P03-C9
</code></pre>
<p>単純な構成なので、10xGenomics は CSV サンプルシートを使用することを推奨しています。</p>
<table>
<thead>
<tr>
<th align="left">列名</th>
<th align="left">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Lane</td>
<td align="left">処理するフローセルのレーン。単一レーン、範囲（2〜4など）、または「*」のいずれかになります。</td>
</tr>
<tr>
<td align="left">Sample</td>
<td align="left">サンプルの名前。この名前は、生成されたすべての FASTQ ファイルのprefixとなり、すべてのダウンストリーム10xパイプラインの <code>--sample</code> 引数に対応します。 サンプル名は、イルミナの bcl2fastq 命名要件に準拠している必要があります。文字、数字、アンダースコア(_)、ハイフン(-)のみが許可されています。ドット(.)を含む他の記号は使用できません。</td>
</tr>
<tr>
<td align="left">Index</td>
<td align="left">ライブラリ構築に使用した 10x のサンプルインデックスセット, e.g., SI-GA-A12.</td>
</tr>
</tbody>
</table>
<h3>
<a id="user-content-2-4---samplesheet-オプション-を使用して-mkfastq-を実行する" class="anchor" href="#2-4---samplesheet-%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3-%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6-mkfastq-%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2-4. --samplesheet オプション を使用して mkfastq を実行する</h3>
<p><code>cellranger mkfastq</code> コマンドを実行します。</p>
<div class="highlight highlight-source-shell"><pre><span class="pl-c1">cd</span> /work
cellranger mkfastq --id=tiny-bcl2 --run=./data/cellranger-tiny-bcl-1.2.0 --samplesheet=./data/cellranger-tiny-bcl-samplesheet-1.2.0.csv</pre></div>
<h3>
<a id="user-content-2-5-quality-control-をつけて実行" class="anchor" href="#2-5-quality-control-%E3%82%92%E3%81%A4%E3%81%91%E3%81%A6%E5%AE%9F%E8%A1%8C" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2-5. Quality Control をつけて実行</h3>
<p><code>--qc</code> オプションをつけて実行します。</p>
<pre><code>cellranger mkfastq --id=tiny-bcl3 --run=./data/cellranger-tiny-bcl-1.2.0 --samplesheet=./data/cellranger-tiny-bcl-samplesheet-1.2.0.csv --qc
</code></pre>
<p>QC出力結果と構成については 10xGENOMICS のドキュメント <a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/using/mkfastq#qc_metrics" rel="nofollow">Reading Quality Control Metrics</a> を参照してください。</p>
<hr>
<p><a href="./03_count.html">3. cellranger count を実行してみる</a> に進んでください。</p>

</body>
</html>
